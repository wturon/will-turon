Type: AWS::Amplify::App
Properties:
  Name: admin-app-${opt:stage}
  Repository: https://github.com/wturon/will-turon
  AccessToken: ${env:REPO_ACCESS_TOKEN, ''}
  BuildSpec: |-
    version: 0.1
    frontend:
      phases:
        preBuild:
          commands:
            - pwd
            - cd web
            - npm install
            - cd ..
        build:
          commands:
            - cd web
            - npm run build
            - pwd
            - ls
            - cd ..
      artifacts:
        baseDirectory: web/build
        files:
          - "**/*"
      cache:
        paths:
          - node_modules/**/*
  CustomRules:
    - Source: </^[^.]+$|\.(?!(css|gif|ico|jpg|js|png|txt|svg|woff|woff2|ttf|map|json|webp)$)([^.]+$)/>
      Status: 200
      Target: /index.html
